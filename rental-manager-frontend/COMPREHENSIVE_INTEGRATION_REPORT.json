{
  "timestamp": "2025-08-27T15:38:46.415Z",
  "integrationScore": 60,
  "codeAnalysis": {
    "purchaseServiceIntegration": false,
    "inventoryServiceMethods": true,
    "autoCompleteSchema": true,
    "frontendIntegration": true
  },
  "schemaAnalysis": {
    "inventoryUnitsTable": false,
    "stockLevelsTable": false,
    "stockMovementsTable": false,
    "foreignKeys": true,
    "inventory_unitsTable": true,
    "stock_levelsTable": true,
    "stock_movementsTable": true,
    "transactionHeadersTable": true
  },
  "apiStatus": {
    "healthCheck": true,
    "endpointsAccessible": true,
    "databaseConnectivity": true
  },
  "currentState": {
    "inventoryUnits": 0,
    "stockLevels": 1,
    "stockMovements": 2,
    "purchaseTransactions": 15,
    "completedPurchases": 1
  },
  "baseline": {
    "timestamp": "2025-08-27T15:26:04.320Z",
    "baseline": {
      "dbConnectivity": true,
      "apiHealth": true,
      "inventory_units": 0,
      "stock_levels": 1,
      "stock_movements": 2,
      "purchase_transactions": 15,
      "completed_purchases": 1,
      "transaction_lines": 12,
      "testDataStatus": {
        "supplier": {
          "exists": true,
          "name": "company_name"
        },
        "location": {
          "exists": true,
          "name": "location_name"
        },
        "item": {
          "exists": true,
          "name": "item_name"
        }
      },
      "itemStock": {
        "exists": true,
        "quantity_on_hand": 5,
        "quantity_available": 5,
        "average_cost": 25,
        "item_name": "Test Item 1756114080519"
      },
      "existingUnits": 0,
      "purchaseMovements": 1
    },
    "testData": {
      "supplier_id": "b128a522-2923-4535-98fa-0f04db881ab4",
      "location_id": "70b8dc79-846b-47be-9450-507401a27494",
      "item_id": "bb2c8224-755d-4005-8868-b0683944364f"
    }
  },
  "executionResults": {
    "timestamp": "2025-08-27T15:28:05.451Z",
    "results": [
      {
        "testName": "Single Item Purchase",
        "payload": {
          "supplier_id": "b128a522-2923-4535-98fa-0f04db881ab4",
          "location_id": "70b8dc79-846b-47be-9450-507401a27494",
          "auto_complete": true,
          "items": [
            {
              "item_id": "bb2c8224-755d-4005-8868-b0683944364f",
              "location_id": "70b8dc79-846b-47be-9450-507401a27494",
              "quantity": 3,
              "unit_price": 25,
              "batch_code": "BATCH-TEST-1756308482854"
            }
          ],
          "currency": "INR",
          "shipping_amount": 0,
          "other_charges": 0,
          "notes": "Verification test - single item purchase"
        },
        "httpCode": 500,
        "success": false,
        "response": "{\"error\":\"Internal server error\",\"detail\":\"(sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: 'dev-user-1' (invalid UUID 'dev-user-1': length must be between 32..36 characters, got 10)\\n[SQL: INSERT INTO transaction_events (transaction_id, event_type, event_category, description, event_data, user_id, session_id, ip_address, user_agent, service_name, operation_name, correlation_id, event_timestamp, processing_duration_ms, status, error_code, error_message, affected_entities, created_at, updated_at, created_by, updated_by, is_active, deleted_at, deleted_by) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::JSON, $6::UUID, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::TIMESTAMP WITH TIME ZONE, $14::VARCHAR, $15::VARCHAR, $16::VARCHAR, $17::VARCHAR, $18::JSON, $19::TIMESTAMP WITH TIME ZONE, $20::TIMESTAMP WITH TIME ZONE, $21::VARCHAR, $22::VARCHAR, $23::BOOLEAN, $24::TIMESTAMP WITH TIME ZONE, $25::VARCHAR) RETURNING transaction_events.id]\\n[parameters: (UUID('e6389461-ae5c-44de-8233-c26a13fc8339'), 'PURCHASE_CREATED', 'TRANSACTION', 'Purchase transaction PUR-20250827-0007 created', '{}', 'dev-user-1', None, None, None, None, 'create_purchase', None, datetime.datetime(2025, 8, 27, 15, 28, 2, 916827, tzinfo=datetime.timezone.utc), '28', 'SUCCESS', None, None, '{}', datetime.datetime(2025, 8, 27, 15, 28, 2, 917559, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 27, 15, 28, 2, 917559, tzinfo=datetime.timezone.utc), None, None, True, None, None)]\\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\",\"request_id\":\"5f68a8e4-3268-4865-bc11-5edcb4bd8909\"}",
        "timestamp": "2025-08-27T15:28:02.949Z",
        "knownError": "user_uuid_issue"
      },
      {
        "testName": "Multi Item Purchase",
        "payload": {
          "supplier_id": "b128a522-2923-4535-98fa-0f04db881ab4",
          "location_id": "70b8dc79-846b-47be-9450-507401a27494",
          "auto_complete": true,
          "items": [
            {
              "item_id": "bb2c8224-755d-4005-8868-b0683944364f",
              "location_id": "70b8dc79-846b-47be-9450-507401a27494",
              "quantity": 2,
              "unit_price": 25,
              "batch_code": "MULTI-A-1756308484950"
            },
            {
              "item_id": "bb2c8224-755d-4005-8868-b0683944364f",
              "location_id": "70b8dc79-846b-47be-9450-507401a27494",
              "quantity": 1,
              "unit_price": 30,
              "batch_code": "MULTI-B-1756308484950"
            }
          ],
          "currency": "INR",
          "shipping_amount": 5,
          "other_charges": 2.5,
          "notes": "Verification test - multi item purchase"
        },
        "httpCode": 500,
        "success": false,
        "response": "{\"error\":\"Internal server error\",\"detail\":\"(sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $6: 'dev-user-1' (invalid UUID 'dev-user-1': length must be between 32..36 characters, got 10)\\n[SQL: INSERT INTO transaction_events (transaction_id, event_type, event_category, description, event_data, user_id, session_id, ip_address, user_agent, service_name, operation_name, correlation_id, event_timestamp, processing_duration_ms, status, error_code, error_message, affected_entities, created_at, updated_at, created_by, updated_by, is_active, deleted_at, deleted_by) VALUES ($1::UUID, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::JSON, $6::UUID, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::TIMESTAMP WITH TIME ZONE, $14::VARCHAR, $15::VARCHAR, $16::VARCHAR, $17::VARCHAR, $18::JSON, $19::TIMESTAMP WITH TIME ZONE, $20::TIMESTAMP WITH TIME ZONE, $21::VARCHAR, $22::VARCHAR, $23::BOOLEAN, $24::TIMESTAMP WITH TIME ZONE, $25::VARCHAR) RETURNING transaction_events.id]\\n[parameters: (UUID('f5f8fd7d-bee0-45c7-bdae-456dae34e8f5'), 'PURCHASE_CREATED', 'TRANSACTION', 'Purchase transaction PUR-20250827-0007 created', '{}', 'dev-user-1', None, None, None, None, 'create_purchase', None, datetime.datetime(2025, 8, 27, 15, 28, 5, 9159, tzinfo=datetime.timezone.utc), '28', 'SUCCESS', None, None, '{}', datetime.datetime(2025, 8, 27, 15, 28, 5, 9399, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 8, 27, 15, 28, 5, 9399, tzinfo=datetime.timezone.utc), None, None, True, None, None)]\\n(Background on this error at: https://sqlalche.me/e/20/dbapi)\",\"request_id\":\"27e3d856-7b93-4b85-9e04-c989acbe0faa\"}",
        "timestamp": "2025-08-27T15:28:05.029Z",
        "knownError": "user_uuid_issue"
      }
    ],
    "purchaseIds": [],
    "baseline": {
      "dbConnectivity": true,
      "apiHealth": true,
      "inventory_units": 0,
      "stock_levels": 1,
      "stock_movements": 2,
      "purchase_transactions": 15,
      "completed_purchases": 1,
      "transaction_lines": 12,
      "testDataStatus": {
        "supplier": {
          "exists": true,
          "name": "company_name"
        },
        "location": {
          "exists": true,
          "name": "location_name"
        },
        "item": {
          "exists": true,
          "name": "item_name"
        }
      },
      "itemStock": {
        "exists": true,
        "quantity_on_hand": 5,
        "quantity_available": 5,
        "average_cost": 25,
        "item_name": "Test Item 1756114080519"
      },
      "existingUnits": 0,
      "purchaseMovements": 1
    }
  },
  "verificationResults": {
    "timestamp": "2025-08-27T15:35:48.775Z",
    "successRate": 0,
    "testResults": [
      {
        "name": "Create Test Purchase Transaction",
        "status": "FAILED",
        "details": "Failed to create test transaction: Query failed: Command failed: docker exec rental_manager_postgres psql -U rental_user -d rental_db -c \"\n                    INSERT INTO transaction_headers (\n                        id, transaction_type, transaction_number, status,\n                        transaction_date, supplier_id, location_id, currency,\n                        subtotal, discount_amount, tax_amount, shipping_amount,\n                        total_amount, paid_amount, deposit_paid, customer_advance_balance,\n                        delivery_required, pickup_required, extension_count, total_extension_charges,\n                        payment_status, payment_method, is_active, created_at, updated_at, notes\n                    ) VALUES (\n                        'test-purchase-08948094', 'PURCHASE', 'PUR-TEST-8094', 'COMPLETED',\n                        '2025-08-27T15:35:48.094Z', 'b128a522-2923-4535-98fa-0f04db881ab4', '70b8dc79-846b-47be-9450-507401a27494', 'INR',\n                        75.00, 0.00, 7.50, 0.00, 82.50, 0.00, false, 0.00,\n                        false, false, 0, 0.00, 'PENDING', 'BANK_TRANSFER',\n                        true, '2025-08-27T15:35:48.094Z', '2025-08-27T15:35:48.094Z', 'Direct inventory verification test'\n                    ) RETURNING id\n                \"\nERROR:  invalid input syntax for type uuid: \"test-purchase-08948094\"\nLINE 10:                         'test-purchase-08948094', 'PURCHASE'...\n                                 ^\n"
      },
      {
        "name": "Simulate Inventory Service Updates",
        "status": "FAILED",
        "details": "Cannot simulate updates - transaction creation failed"
      },
      {
        "name": "Verify inventory_units Table Updates",
        "status": "FAILED",
        "details": "inventory_units table not updated as expected: 0 new units (expected 3)",
        "data": {
          "baselineCount": 0,
          "currentCount": 0,
          "newUnitsCount": 0,
          "expectedIncrease": 3,
          "unitsDetails": "id | sku | batch_code | status | condition | quantity | purchase_price \n----+-----+------------+--------+-----------+----------+----------------\n(0 rows)"
        }
      },
      {
        "name": "Verify stock_levels Table Updates",
        "status": "FAILED",
        "details": "stock_levels not updated as expected: quantity 5 (expected >= 8)",
        "data": {
          "baselineQuantity": 5,
          "currentQuantity": 5,
          "expectedQuantity": 8,
          "quantityOnHand": 5,
          "quantityAvailable": 5,
          "recentlyUpdated": false,
          "updatedAt": "2025-08-27 07:05:21.744744+00"
        }
      },
      {
        "name": "Verify stock_movements Table Updates",
        "status": "FAILED",
        "details": "No purchase movements found for test item in recent timeframe",
        "data": {
          "baselineMovements": 1,
          "currentMovements": 0,
          "expectedNewMovements": 1
        }
      },
      {
        "name": "Verify Transaction-Inventory Linkage",
        "status": "FAILED",
        "details": "No transaction linkage found for recent purchase movements"
      }
    ],
    "baseline": {
      "dbConnectivity": true,
      "apiHealth": true,
      "inventory_units": 0,
      "stock_levels": 1,
      "stock_movements": 2,
      "purchase_transactions": 15,
      "completed_purchases": 1,
      "transaction_lines": 12,
      "testDataStatus": {
        "supplier": {
          "exists": true,
          "name": "company_name"
        },
        "location": {
          "exists": true,
          "name": "location_name"
        },
        "item": {
          "exists": true,
          "name": "item_name"
        }
      },
      "itemStock": {
        "exists": true,
        "quantity_on_hand": 5,
        "quantity_available": 5,
        "average_cost": 25,
        "item_name": "Test Item 1756114080519"
      },
      "existingUnits": 0,
      "purchaseMovements": 1
    },
    "summary": {
      "totalTests": 6,
      "passed": 0,
      "failed": 6,
      "errors": 0
    }
  },
  "summary": {
    "status": "NEEDS_WORK",
    "confidenceLevel": "LOW",
    "productionReady": false
  }
}